

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Configuration and topology files &mdash; oxDNA  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Relaxing initial configurations" href="relaxation.html" />
    <link rel="prev" title="Input file" href="input.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> oxDNA
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Input file</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration and topology files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#configuration-file">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="#topology-file">Topology file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#classic-format-3-to-5">Classic format (3’ <span class="math notranslate nohighlight">\(\to\)</span> 5’)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#new-format-5-to-3">New format (5’ <span class="math notranslate nohighlight">\(\to\)</span> 3’)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#special-nucleotides">Special nucleotides</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#converting-to-and-from-oxdna-configurations">Converting to and from oxDNA configurations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="relaxation.html">Relaxing initial configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="scaling.html">Efficient GPU usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="forces.html">External forces</a></li>
<li class="toctree-l1"><a class="reference internal" href="observables.html">Observables</a></li>
<li class="toctree-l1"><a class="reference internal" href="umbrella_sampling.html">Umbrella sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="ffs.html">Forward Flux Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="events.html">Events</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oat/index.html">oxDNA Analysis Tools</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oxpy/index.html">Oxpy</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">oxDNA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Configuration and topology files</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/configurations.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="configuration-and-topology-files">
<h1>Configuration and topology files<a class="headerlink" href="#configuration-and-topology-files" title="Permalink to this headline">¶</a></h1>
<p>The current state of a system, as specified by oxDNA, is described by two files: a configuration file and a topology file. The configuration file contains all the general information (timestep, energy and box size) and the orientations and positions of each nucleotide. The topology file, on the other hand, keeps track of the backbone-backbone bonds between nucleotides in the same strand. Working configuration and topology files can be found in the <code class="docutils literal notranslate"><span class="pre">examples</span></code> directory.</p>
<div class="section" id="configuration-file">
<h2>Configuration file<a class="headerlink" href="#configuration-file" title="Permalink to this headline">¶</a></h2>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Nucleotides are listed in the 3’ <span class="math notranslate nohighlight">\(\to\)</span> 5’ order if using the “classic” topology format or in the 5’ <span class="math notranslate nohighlight">\(\to\)</span> 3’ order if using the “new” format (see <a class="reference internal" href="#topology-file"><span class="std std-doc">Topology file</span></a>).</p>
</div>
<p>The first three rows of a configuration file contain the timestep T at which the configuration has been printed, the length of the box sides Lx, Ly and Lz and the total, potential and kinetic energies, Etot, U and K, respectively:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>t = T
b = Lz Ly Lz
E = Etot U K
</pre></div>
</div>
<p>After this header, each row contains position of the centre of mass, orientation, velocity and angular velocity of a single nucleotide in the following order:</p>
<div class="math notranslate nohighlight">
\[
\overbrace{r_x r_y r_z}^{\rm centre-of-mass\,\, position\,\, r} \underbrace{b_x b_y b_z}_{{\rm base\,\, vector\,\,} \vec{a}_1} \overbrace{n_x n_y n_z}^{{\rm base\,\, normal\,\, vector\,\,} \vec{a}_3} \underbrace{v_x v_y v_z}_{\rm Velocity} \overbrace{L_x L_y L_z}^{\rm Angular\,\, velocity}
\]</div>
<p><span class="math notranslate nohighlight">\(\vec{a}_1\)</span>, <span class="math notranslate nohighlight">\(\vec{a}_2 = \vec{a}_3 \times \vec{a}_1\)</span> and <span class="math notranslate nohighlight">\(\vec{a}_3\)</span> define the local reference frame through which the position of all interaction sites relative to the centre of mass are calculated. The position of the interaction sites can be recovered as follows:</p>
<ul class="simple">
<li><p>for oxDNA1:</p>
<ul>
<li><p>hydrogen-bonding/repulsion site <span class="math notranslate nohighlight">\( = \vec{r} + 0.4 \, \vec{a}_1\)</span>;</p></li>
<li><p>stacking site <span class="math notranslate nohighlight">\( = \vec{r} + 0.34 \, \vec{a}_1\)</span>;</p></li>
<li><p>backbone repulsion site <span class="math notranslate nohighlight">\( = \vec{r} - 0.4 \, \vec{a}_1\)</span>.</p></li>
</ul>
</li>
<li><p>For oxDNA2:</p>
<ul>
<li><p>hydrogen-bonding site <span class="math notranslate nohighlight">\( = \vec{r} + 0.4 \, \vec{a}_1\)</span>;</p></li>
<li><p>stacking site <span class="math notranslate nohighlight">\( = \vec{r} + 0.34 \, \vec{a}_1\)</span>;</p></li>
<li><p>backbone repulsion site <span class="math notranslate nohighlight">\( = \vec{r} - 0.34 \, \vec{a}_1 + 0.3408 \, \vec{a}_2\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The position of the centre of mass of the nucleotides in oxDNA1 (0.4 length units away from the backbone site) is different from what the PhD thesis of T. E. Ouldridge specifies (0.24 length units away from the backbone site). This change has no effect on the thermodynamics, and the extent to which it changes the dynamics is arguably very small.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When simulating very large structures the size of the trajectory files stored on disk may become very large. In this case it may be convenient to avoid printing the last six columns by setting <code class="docutils literal notranslate"><span class="pre">trajectory_print_momenta</span> <span class="pre">=</span> <span class="pre">false</span></code> in the input file, thus decreasing the size of the trajectory by <span class="math notranslate nohighlight">\(\approx 40\%\)</span>.</p>
</div>
</div>
<div class="section" id="topology-file">
<h2>Topology file<a class="headerlink" href="#topology-file" title="Permalink to this headline">¶</a></h2>
<p>The topology file stores information about the fixed-bonding topology (<em>i.e.</em> which nucleotides share backbone links), as well as the strand sequences. Along with the original topology format (the “classic” one which is in the 3’-5’ direction), starting with version 3.6, oxDNA also supports a new format that is simpler and more flexible (and in 5’-3’ direction). Note that this “new” format is not necessarily supported by the other tools of the oxDNA ecosystem.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can interconvert between the classic and new formats by using the <code class="docutils literal notranslate"><span class="pre">utils/convert.py</span></code> script.</p>
</div>
<div class="section" id="classic-format-3-to-5">
<h3>Classic format (3’ <span class="math notranslate nohighlight">\(\to\)</span> 5’)<a class="headerlink" href="#classic-format-3-to-5" title="Permalink to this headline">¶</a></h3>
<p>The first row contains the total number of nucleotides N and the number of strands Ns:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>N Ns
</pre></div>
</div>
<p>After this header, the <em>i</em>-th row specifies strand, base and 3’ and 5’ neighbours of the <em>i</em>-th nucleotide in this way:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>S B 3&#39; 5&#39;
</pre></div>
</div>
<p>where S is the index of the strand (starting from 1) which the nucleotide belongs to, B is the base (<em>A</em>, <em>C</em>, <em>G</em>, and <em>T</em> for DNA or <em>A</em>, <em>C</em>, <em>G</em>, and <em>U</em> for RNA, but see below for more options) and 3’ and 5’ specify the index of the nucleotides with which the <em>i</em>-th nucleotide is bonded in the 3’ and 5’ direction, respectively. A -1 signals that the nucleotide terminates the strand in either 3’ or 5’ direction.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>OxDNA’s “classic topology” convention is to list nucleotides in the 3’ <span class="math notranslate nohighlight">\(\to\)</span> 5’ order. Note that this is the opposite of how most of the other DNA-related tools behave.</p>
</div>
<p>The topology file of a strand of sequence GCGTTG would be:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>6 1
1 G -1 1
1 C 0 2
1 G 1 3
1 T 2 4
1 T 3 5
1 G 4 -1
</pre></div>
</div>
<p>Specifying the topology in this way can simplify the process of simulating, for example, circular DNA.</p>
</div>
<div class="section" id="new-format-5-to-3">
<h3>New format (5’ <span class="math notranslate nohighlight">\(\to\)</span> 3’)<a class="headerlink" href="#new-format-5-to-3" title="Permalink to this headline">¶</a></h3>
<p>The new format (introduced in oxDNA 3.6) lists nucleotides in the more common order (5’ <span class="math notranslate nohighlight">\(\to\)</span> 3’), is (arguably) simpler, and is more flexible. However, it is not fully supported by all oxDNA-related tools yet.</p>
<p>The first row of the topology should contain the total number of nucleotides N, the number of strands Ns and the “5-&gt;3” string to signal that the file has the “new” format:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>N Ns 5-&gt;3
</pre></div>
</div>
<p>Each of the Ns rows that follows contains the details of a single strand as a space-separated list of elements. The first element is the sequence of the strand (in 5’ <span class="math notranslate nohighlight">\(\to\)</span> 3’ order), while additional elements can be specified with the key=value syntax. The topology of the same system used as an example of “classic” topology (<em>i.e.</em> a system composed of a single strand of sequence GTTGCG) is</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>6 1 5-&gt;3
GTTGCG
</pre></div>
</div>
<p>As another example, the topology of a system composed by two complementary strands would be</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">12</span> <span class="mi">2</span> <span class="mi">5</span><span class="o">-&gt;</span><span class="mi">3</span>
<span class="n">GTTGCG</span>
<span class="n">CGCAAC</span>
</pre></div>
</div>
<p>In addition, DNA and RNA interactions also support the <code class="docutils literal notranslate"><span class="pre">type=DNA|RNA</span></code> (which defaults to <code class="docutils literal notranslate"><span class="pre">DNA</span></code>) and <code class="docutils literal notranslate"><span class="pre">circular=true|false</span></code> (which defaults to <code class="docutils literal notranslate"><span class="pre">false</span></code>) specifiers. The former sets the type of strand, while the latter, if set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, indicates that the strand is circular. For example, if you wanted to explicitally note that the above strands are DNA, the file would read</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">12</span> <span class="mi">2</span> <span class="mi">5</span><span class="o">-&gt;</span><span class="mi">3</span>
<span class="n">GTTGCG</span> <span class="nb">type</span><span class="o">=</span><span class="n">DNA</span>
<span class="n">CGCAAC</span> <span class="nb">type</span><span class="o">=</span><span class="n">DNA</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting <code class="docutils literal notranslate"><span class="pre">type</span></code> only affects the force field when using the DNA/RNA hybrid model (<code class="docutils literal notranslate"><span class="pre">interaction_type=DRH</span></code>). For normal DNA or RNA, the interactions will be determined by the <code class="docutils literal notranslate"><span class="pre">interaction_type=DNA|DNA2|RNA|RNA2|DRH|LJ...</span></code> parameter in the <a class="reference internal" href="input.html"><span class="doc std std-doc">input file</span></a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">examples/PERSISTENCE_LENGTH/NEW_TOPOLOGY</span></code> directory contains an example that uses this new format.</p>
</div>
</div>
<div class="section" id="special-nucleotides">
<h3>Special nucleotides<a class="headerlink" href="#special-nucleotides" title="Permalink to this headline">¶</a></h3>
<p>Internally, oxDNA encodes the base types with integers as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>A = 0
G = 1
C = 2
T = U = 3
</pre></div>
</div>
<p>According to these values, two nucleotides interact through the Watson-Crick mechanism (<em>i.e.</em> can be hydrogen bonded) if the sum of their base types is 3.</p>
<p>This property can be leveraged to extend the canonical base pairing and create very specific topologies. Indeed, in oxDNA a nucleotide of custom type X which is larger than 9 or smaller than 0 behaves as a nucleotide of type <span class="math notranslate nohighlight">\(X \bmod 4\)</span> if <span class="math notranslate nohighlight">\(X\)</span> is positive or <span class="math notranslate nohighlight">\(3 - ((3 - X) \bmod 4)\)</span> if <span class="math notranslate nohighlight">\(X\)</span> is negative, but can be hydrogen-bonded <strong>only</strong> with a nucleotide of type <span class="math notranslate nohighlight">\(X'\)</span> for which <span class="math notranslate nohighlight">\(X + X' = 3\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the classic topology format, custom nucleotide types are set by using numbers instead of letters. For instance, the following topology line specifies that the corresponding nucleotide (which is part of strand 1 and bonded to nucleotides 2 and 4) has a custom type <code class="docutils literal notranslate"><span class="pre">-10</span></code>: <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">-10</span> <span class="pre">2</span> <span class="pre">4</span></code>.</p>
<p>In the new topology format, custom nucleotide types can be set by enclosing them between brackets. As an example, the following line sets the sequence of a DNA strand made of 6 nucleotides, with the third one having a custom type <code class="docutils literal notranslate"><span class="pre">-10</span></code>: <code class="docutils literal notranslate"><span class="pre">AA(-10)GCT</span> <span class="pre">type=DNA</span></code>.</p>
</div>
<p>For instance, <span class="math notranslate nohighlight">\(B = 13\)</span>, for which <span class="math notranslate nohighlight">\(B \bmod 4 = 1\)</span>, would correspond to a nucleotide with the same property of a Guanine. However, such a nucleotide would bond only to a nucleotide with base type <span class="math notranslate nohighlight">\(B' = -10\)</span>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The CUDA backend supports base types whose absolute values do not exceed <span class="math notranslate nohighlight">\(2^{9} - 1 = 511\)</span>. In other words, base types larger than <span class="math notranslate nohighlight">\(511\)</span> or smaller than <span class="math notranslate nohighlight">\(-511\)</span> are not allowed.</p>
</div>
</div>
</div>
<div class="section" id="converting-to-and-from-oxdna-configurations">
<h2>Converting to and from oxDNA configurations<a class="headerlink" href="#converting-to-and-from-oxdna-configurations" title="Permalink to this headline">¶</a></h2>
<p>Many DNA-nanotechnology tools support exporting to oxDNA configurations, as well as converting between different formats (see <em>e.g.</em> <a class="reference external" href="https://doi.org/10.1002/jcc.26029">tacoxDNA</a>, <a class="reference external" href="https://academic.oup.com/nar/article/48/12/e72/5843822">oxView</a>, <a class="reference external" href="https://doi.org/10.1093/nar/gkaa593">Adenita</a>, <a class="reference external" href="https://doi.org/10.1093/nar/gkaa200">MrDNA</a>).</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="relaxation.html" class="btn btn-neutral float-right" title="Relaxing initial configurations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="input.html" class="btn btn-neutral float-left" title="Input file" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2022, Lorenzo Rovigatti, Flavio Romano, Erik Poppleton, Michael Matthies, and Petr Šulc

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>