

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Modifying external forces at runtime &mdash; oxDNA  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Writing observables in Python" href="observables.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> oxDNA
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../input.html">Input file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configurations.html">Configuration and topology files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../relaxation.html">Relaxing initial configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scaling.html">Efficient GPU usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../forces.html">External forces</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../observables.html">Observables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../umbrella_sampling.html">Umbrella sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ffs.html">Forward Flux Sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../events.html">Events</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../oat/index.html">oxDNA Analysis Tools</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Oxpy</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#an-example-of-a-simple-simulation">An example of a simple simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#an-example-of-a-simple-analysis">An example of a simple analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#library-api">Library API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#exceptions">Exceptions</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#extending-oxpy">Extending Oxpy</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="observables.html">Writing observables in Python</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Modifying external forces at runtime</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">oxDNA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Oxpy</a> &raquo;</li>
        
      <li>Modifying external forces at runtime</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/oxpy/extending/forces.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="tex2jax_ignore mathjax_ignore section" id="modifying-external-forces-at-runtime">
<h1>Modifying external forces at runtime<a class="headerlink" href="#modifying-external-forces-at-runtime" title="Permalink to this headline">¶</a></h1>
<p>While it is not yet possible to write external forces entirely in Python, with oxpy you can change the parameters of some external forces while the simulation is running. The list of the available forces (and the parameters that can be changed) can be found <a class="reference internal" href="../modules/core/forces.html"><span class="doc std std-doc">here</span></a>. All external forces can be accessed by using <a class="reference internal" href="../modules/core/core.html#oxpy.core.ConfigInfo" title="oxpy.core.ConfigInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigInfo</span></code></a>’s <a class="reference internal" href="../modules/core/core.html#oxpy.core.ConfigInfo.forces" title="oxpy.core.ConfigInfo.forces"><code class="xref py py-attr docutils literal notranslate"><span class="pre">forces</span></code></a> attribute.</p>
<p>Here is an example that can be run in the <code class="docutils literal notranslate"><span class="pre">examples/TRAPS</span></code> folder which doubles the stiffness of all forces every 20000 simulation steps:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">oxpy</span>

<span class="k">with</span> <span class="n">oxpy</span><span class="o">.</span><span class="n">Context</span><span class="p">():</span>
    <span class="n">manager</span> <span class="o">=</span> <span class="n">oxpy</span><span class="o">.</span><span class="n">OxpyManager</span><span class="p">(</span><span class="s2">&quot;inputMD&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">manager</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="mi">20000</span><span class="p">)</span>

        <span class="c1"># double the stiffness of all forces after every iteration</span>
        <span class="k">for</span> <span class="n">force</span> <span class="ow">in</span> <span class="n">manager</span><span class="o">.</span><span class="n">config_info</span><span class="p">()</span><span class="o">.</span><span class="n">forces</span><span class="p">:</span>
            <span class="n">force</span><span class="o">.</span><span class="n">stiff</span> <span class="o">*=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>Note that you can modify only some specific forces by using the <code class="docutils literal notranslate"><span class="pre">id</span></code> and <code class="docutils literal notranslate"><span class="pre">group_name</span></code> options in the external forces file.</p>
<p>For instance, imagine we have the following forces defined in the external forces file (similar to the <code class="docutils literal notranslate"><span class="pre">external.conf</span></code> file
of the <code class="docutils literal notranslate"><span class="pre">examples/TRAPS</span></code> folder):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{
type = trap
id = first_force
group_name = pulling_forces
particle = 0
stiff = 1.00
pos0 = 46.3113780977, 11.1604626391, 26.8730311801
rate = 0.
dir = 0.,0.,-1.
}

{
type = trap
id = last_force
group_name = pulling_forces
particle = 99
pos0 = 83.1532046751, 15.950789638, 37.3071701142
stiff = 1.0
rate = 0.
dir = 0.,0.,1.
}
</pre></div>
</div>
<p>We can now access only these two forces by using <a class="reference internal" href="../modules/core/forces.html#oxpy.core.forces.BaseForce" title="oxpy.core.forces.BaseForce"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseForce</span></code></a>’s <a class="reference internal" href="../modules/core/forces.html#oxpy.core.forces.BaseForce.group_name" title="oxpy.core.forces.BaseForce.group_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">group_name</span></code></a> attribute:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">force</span> <span class="ow">in</span> <span class="n">manager</span><span class="o">.</span><span class="n">config_info</span><span class="p">()</span><span class="o">.</span><span class="n">forces</span><span class="p">:</span>
	<span class="k">if</span> <span class="n">force</span><span class="o">.</span><span class="n">group_name</span> <span class="o">==</span> <span class="s2">&quot;pulling_forces&quot;</span><span class="p">:</span>
		<span class="n">force</span><span class="o">.</span><span class="n">stiff</span> <span class="o">*=</span> <span class="mi">2</span>
</pre></div>
</div>
<p>or we can access one specific force by using <a class="reference internal" href="../modules/core/core.html#oxpy.core.ConfigInfo" title="oxpy.core.ConfigInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigInfo</span></code></a>’s <a class="reference internal" href="../modules/core/core.html#oxpy.core.ConfigInfo.get_force_by_id" title="oxpy.core.ConfigInfo.get_force_by_id"><code class="xref py py-attr docutils literal notranslate"><span class="pre">get_force_by_id</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_force</span> <span class="o">=</span> <span class="n">manager</span><span class="o">.</span><span class="n">config_info</span><span class="p">()</span><span class="o">.</span><span class="n">get_force_by_id</span><span class="p">(</span><span class="s2">&quot;first_force&quot;</span><span class="p">)</span>
<span class="n">my_force</span><span class="o">.</span><span class="n">stiff</span> <span class="o">*=</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="../modules/core/forces.html#oxpy.core.forces.BaseForce.id" title="oxpy.core.forces.BaseForce.id"><code class="xref py py-attr docutils literal notranslate"><span class="pre">id</span></code></a> and <a class="reference internal" href="../modules/core/forces.html#oxpy.core.forces.BaseForce.group_name" title="oxpy.core.forces.BaseForce.group_name"><code class="xref py py-attr docutils literal notranslate"><span class="pre">group_name</span></code></a> attributes can also be changed from the Python’s side!</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="observables.html" class="btn btn-neutral float-left" title="Writing observables in Python" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2022, Lorenzo Rovigatti, Flavio Romano, Erik Poppleton, Michael Matthies, and Petr Šulc

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>